<div>
  <app-nav></app-nav>
  <div class="app-content">
    <div class="checkbox">
        <label><input type="checkbox" [(ngModel)]="showAll">Show All Transactions</label>
    </div>
    <table class="table table-hovered table-center">
      <thead>
        <tr>
          <th>Name</th>
          <th>Symbol</th>
          <th class="right">Shares</th>
          <th class="right">Avg.Cost</th>
          <th class="right">Price</th>
          <th class="right">Day Change</th>
          <th class="right">Day Change %</th>
          <th class="right">Market Value</th>
          <th class="right">Total Gain</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let p of positions">
          <tr>
            <td>{{ p.name }}</td>
            <td>{{ p.symbol }}</td>
            <td  class="right">{{ getSum(p.transactions) }} </td>
            <td class="right">{{ getAvg(p.transactions) }} </td>
            <td class="right">{{ p.quote | number:'1.1-5'}}</td>
            <td class="right"><ed-colored-text [num]="(p.quote-p.adjusted_previous_close)"></ed-colored-text></td>
            <td class="right"><ed-colored-text [num]="((p.quote-p.adjusted_previous_close)/p.adjusted_previous_close)*100 "></ed-colored-text></td>
            <td class="right">{{ (p.quote*getSum(p.transactions)) | number:'3.1-3' }}</td>
            <td class="right"><ed-colored-text [num]="getTotalGain(p)"></ed-colored-text></td></tr>
          <ng-container *ngIf="p.transactions.length > 1 && showAll">
            <tr *ngFor="let t of p.transactions" [ngClass]="{ odd: odd, even: even }">
              <td></td>
              <td></td>
              <td class="right">{{ t.shares }} </td>
              <td class="right">{{ t.price }}</td>
            </tr>
          </ng-container>
        </ng-container>
      </tbody>
      <tfoot>
        <tr>
          <th colspan=9 class="right">{{getGrandTotalGain()| number:'3.1-3' }}</th>
        </tr>
      </tfoot>
    </table>
    <br>
    <button type="button" class="btn btn-danger" (click)="removeAll()">CLear Local Storage</button>
    <button type="button" class="btn btn-success" (click)="SaveAsFile()">Save</button>
    <br>
    <br>
    <br>
    <div class="form-inline">
      <input [(ngModel)]="newTransaction.name" placeholder="Name" class="form-control">
      <input [(ngModel)]="newTransaction.symbol" placeholder="Symbol" class="form-control">
      <input [(ngModel)]="newTransaction.shares" class="form-control" placeholder="Shares">
      <input [(ngModel)]="newTransaction.price" class="form-control" placeholder="Purchase Price" (keyup.enter)="addTransaction()">
      <button type="button" class="btn btn-primary" (click)="addTransaction(newTransaction)">Add</button>
    </div>
    <br/>
    <div class="form-inline">
      <textarea class="form-control" rows="5" placeholder="Import CVS" [(ngModel)]="importText"></textarea>
      <button type="button" class="btn btn-warning" (click)="importTransactions()">Import CVS</button>
      <textarea class="form-control" rows="5" placeholder="Import Json" [(ngModel)]="importJson"></textarea>
      <button type="button" class="btn btn-warning" (click)="importJsonTrans()">Import JSON</button>
    </div>
    <br/>
    
  </div>
</div>